#!/usr/bin/env ruby
# -*- coding:utf-8 -*-

require 'freee'

module Freee
  class CLI < Thor
    include Thor::Actions

    desc "token", "Get access token of application for the freee."
    option :client_id
    option :secret_key
    option :redirect_uri
    option :authorization_code
    def token 
      if options[:client_id]
        client_id = options[:client_id].strip
      else
        client_id = ask("Client ID\n")
      end

      if options[:secret_key]
        secret_key = options[:secret_key].strip
      else
        secret_key = ask("Secret Key\n")
      end

      if options[:redirect_uri]
        redirect_uri = options[:redirect_uri]
      else
        redirect_uri = ask("Redirect URI\n")
      end

      if options[:authorization_code]
        authorization_code = options[:authorization_code]
      else
        authorization_code = ask("Authorization code\n")
      end

      puts 'Token: ' + Freee::Util.create_token(
        client_id: client_id,
        secret_key: secret_key,
        redirect_uri: redirect_uri,
        authorization_code: authorization_code
      )
    end
  end
end

Freee::CLI.start(ARGV)

#/* vim: set syntax=ruby */
